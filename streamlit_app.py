import streamlit as st
import google.generativeai as genai

# Streamlit UI ì´ˆê¸°í™”
st.title("ğŸ’¬ ê°œì¸ì •ë³´ íƒì§€ Chatbot")
st.write(
    "Gemini ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ í…ìŠ¤íŠ¸ ë‚´ ê°œì¸ì •ë³´ë¥¼ íƒì§€í•˜ëŠ” ì±—ë´‡ì…ë‹ˆë‹¤."\
    "Gemini API í‚¤ë¥¼ ì…ë ¥í•œ í›„ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”."
)
st.write(
    "Gemini API í‚¤ë¥¼ ì…ë ¥í•œ í›„ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”."
)

# ì‚¬ìš©ìë¡œë¶€í„° Gemini API í‚¤ ì…ë ¥ ë°›ê¸°
gemini_api_key = st.text_input("Gemini API Key", type="password")
if not gemini_api_key:
    st.info("Gemini API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.", icon="ğŸ”‘")
else:
    genai.configure(api_key=gemini_api_key)

    # Gemini ëª¨ë¸ ì„¤ì •
    system_instruction_first = \
        """
            ## ê°œì¸ì •ë³´ íƒì§€ ìˆ˜í–‰ ë°©ë²•
            1. ì…ë ¥ëœ ê²Œì‹œë¬¼ ë‚´ìš©ì´ ê°œì¸ì •ë³´ ìš”ì†Œì— í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”. 
            2. ë‹µë³€ ì‹œ ì…ë ¥ëœ ê²Œì‹œë¬¼ì—ì„œ ê°œì¸ì •ë³´ ìš”ì†ŒëŠ” í•´ë‹¹ ë‚´ìš©ì— ë§ëŠ” [ ] íƒœê·¸ë¡œ í‘œì‹œí•´ì£¼ì„¸ìš”.
            3. íƒì§€ ì˜ˆì‹œì™€ ë™ì¼í•˜ê²Œ ë‹µë³€ì„ í•´ì£¼ì„¸ìš”. ë‹µë³€ì—ëŠ” ì…ë ¥, íƒœê·¸, ê²°ê³¼ê°€ ëª¨ë‘ í¬í•¨ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
            
            ## ê°œì¸ì •ë³´ ìš”ì†Œ
            1. ì¸ì ì‚¬í•­
                1.1 ì¼ë°˜ì •ë³´: ì„±ëª…, ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸, ì£¼ì†Œ, ì—°ë½ì²˜, ìƒë…„ì›”ì¼, ì¶œìƒì§€, ì„±ë³„ ë“±
                1.2 ê°€ì¡±ì •ë³´: ê°€ì¡±ê´€ê³„ ë° ê°€ì¡±êµ¬ì„±ì› ì •ë³´ ë“±
            2. ì‹ ì²´ì  ì •ë³´
                2.1 ì‹ ì²´ì •ë³´: ì–¼êµ´, í™ì±„, ìŒì„±, ìœ ì „ì ì •ë³´, ì§€ë¬¸, í‚¤, ëª¸ë¬´ê²Œ, ì‚¬ì§„ì´ë‚˜ ë™ì˜ìƒì— ë‚˜ì˜¨ ëª¨ìŠµ  ë“±
                2.2 ì˜ë£Œê±´ê°•ì •ë³´: ê±´ê°•ìƒíƒœ, ì§„ë£Œê¸°ë¡, ì‹ ì²´ì¥ì• , ì¥ì• ë“±ê¸‰, ë³‘ë ¥, í˜ˆì•¡í˜•, IQ, ì•½ë¬¼í…ŒìŠ¤íŠ¸ ë“±ì˜ ì‹ ì²´ê²€ì‚¬ ì •ë³´ ë“±
            3. ì‚¬íšŒì ì •ë³´
                3.1 êµìœ¡ì •ë³´: í•™ë ¥, ì„±ì , ì¶œì„í˜„í™©, ê¸°ìˆ  ìê²©ì¦ ë° ì „ë¬¸ ë©´í—ˆì¦ ë³´ìœ ë‚´ì—­, ìƒë²Œê¸°ë¡, ìƒí™œê¸°ë¡ë¶€, ê±´ê°•ê¸°ë¡ë¶€ ë“±
                3.2 ë³‘ì—­ì •ë³´: ë³‘ì—­ì—¬ë¶€, êµ°ë²ˆ ë° ê³„ê¸‰, ì œëŒ€ìœ í˜•, ê·¼ë¬´ë¶€ëŒ€, ì£¼íŠ¹ê¸° ë“±
                3.3 ê·¼ë¡œì •ë³´: ì§ì¥, ê³ ìš©ì£¼, ê·¼ë¬´ì²˜, ê·¼ë¡œê²½ë ¥, ìƒë²Œê¸°ë¡, ì§ë¬´í‰ê°€ê¸°ë¡ ë“±
                3.4 ë²•ì ì •ë³´: ì „ê³¼ ë²”ì£„ ê¸°ë¡, ì¬íŒ ê¸°ë¡, ê³¼íƒœë£Œ ë‚©ë¶€ë‚´ì—­ ë“±
            4. ì¬ì‚°ì  ì •ë³´
                4.1 ì†Œë“ì •ë³´: ë´‰ê¸‰ì•¡, ë³´ë„ˆìŠ¤ ë° ìˆ˜ìˆ˜ë£Œ, ì´ìì†Œë“, ì‚¬ì—…ì†Œë“ ë“±
                4.2 ì‹ ìš©ì •ë³´: ëŒ€ì¶œ ë° ë‹´ë³´ì„¤ì • ë‚´ì—­, ì‹ ìš©ì¹´ë“œë²ˆí˜¸, í†µì¥ê³„ì¢Œë²ˆí˜¸, ì‹ ìš©í‰ê°€ ì •ë³´ ë“±
                4.3 ë¶€ë™ì‚°ì •ë³´: ì†Œìœ ì£¼íƒ, í† ì§€, ìë™ì°¨, ê¸°íƒ€ ì†Œìœ ì°¨ëŸ‰, ìƒì  ë° ê±´ë¬¼ ë“±
                4.4 ê¸°íƒ€ìˆ˜ìµì •ë³´: ë³´í—˜(ê±´ê°•, ìƒëª… ë“±), ê°€ì…í˜„í™©, íœ´ê°€, ë³‘ê°€ ë“±
            5. ì •ì‹ ì  ì •ë³´
                5.1 ê¸°í˜¸.ì„±í–¥ ì •ë³´: ë„ì„œ.ë¹„ë””ì˜¤ ë“± ëŒ€ì—¬ê¸°ë¡, ì¡ì§€êµ¬ë…ì •ë³´, ë¬¼í’ˆêµ¬ë§¤ë‚´ì—­, ì›¹ì‚¬ì´íŠ¸ê²€ìƒ‰ë‚´ì—­ ë“±
                5.2 ë‚´ë©´ì˜ ë¹„ë°€ ì •ë³´: ì‚¬ìƒ, ì‹ ì¡°, ì¢…êµ, ê°€ì¹˜ê´€, ì •ë‹¹.ë…¸ì¡° ê°€ì…ì—¬ë¶€ ë° í™œë™ë‚´ì—­, ì¸í„°ë„· ëŒ“ê¸€.ê²Œì‹œê¸€, ì¶œíŒë¬¼ ë“±
            6. ê¸°íƒ€ ì •ë³´
                6.1 í†µì‹ ì •ë³´: E-mail ì£¼ì†Œ, ì „í™”í†µí™”ë‚´ì—­, ë¡œê·¸íŒŒì¼, ì¿ í‚¤, SNS ì£¼ì†Œ ë“±
                6.2 ìœ„ì¹˜ì •ë³´: GPS ë° íœ´ëŒ€í°ì— ì˜í•œ ê°œì¸ì˜ ìœ„ì¹˜ì •ë³´ ë“±
                6.3 ìŠµê´€ë°ì·¨ë¯¸ì •ë³´: í¡ì—°ì—¬ë¶€, ìŒì£¼ëŸ‰, ì„ í˜¸í•˜ëŠ” ìŠ¤í¬ì¸  ë° ì˜¤ë½, ì—¬ê°€í™œë™, ë„ë°•ì„±ì„±í–¥ ë“±
                
            ## íƒì§€ ì˜ˆì‹œ
            ì…ë ¥ >> ì–´ì œëŠ” ì¸ì²œ ë‚¨ë™êµ¬ë³µì§€ê´€ ì–´ìš¸ë¦¼ë´‰ì‚¬ë‹¨ì—ì„œ ì¸ì‚¬ë‚˜ëˆ”ìœ¼ë¡œ ë§ˆìŠ¤í¬ 5ë§¤ì™€ ì‚¬íƒ•ì„ ë™ëŒ€í‘œ ì •í˜¸ì”¨ì™€ ì£¼ë¯¼ë“¤ì—ê²Œ ë‚˜ëˆ„ì–´ ì£¼ì—ˆìŠµë‹ˆë‹¤. ì•„ë“¤ë„ í•¨ê»˜ ë‚˜ì˜¨ ì •í˜¸ì”¨ëŠ” ê³ ì§€í˜ˆì¦ì„  3ë…„ì „ì— ì§„ë‹¨ ë°›ì•„ ì•½ì„ ë°›ì•˜ì–´ìš”.
            íƒœê·¸ >> ì–´ì œëŠ” [ì£¼ì†Œ]ì¸ì²œ ë‚¨ë™êµ¬[/ì£¼ì†Œ]ë³µì§€ê´€ ì–´ìš¸ë¦¼ë´‰ì‚¬ë‹¨ì—ì„œ ì¸ì‚¬ë‚˜ëˆ”ìœ¼ë¡œ ë§ˆìŠ¤í¬ 5ë§¤ì™€ ì‚¬íƒ•ì„ ë™ëŒ€í‘œ [ì´ë¦„]ì •í˜¸ì”¨[/ì´ë¦„]ì™€ ì£¼ë¯¼ë“¤ì—ê²Œ ë‚˜ëˆ„ì–´ ì£¼ì—ˆìŠµë‹ˆë‹¤. [ê°€ì¡±ê´€ê³„]ì•„ë“¤[/ê°€ì¡±ê´€ê³„]ë„ í•¨ê»˜ ë‚˜ì˜¨ ì •í˜¸ì”¨ëŠ” [ì˜ë£Œê±´ê°•ì •ë³´]ê³ ì§€í˜ˆì¦ì„  3ë…„ì „ì— ì§„ë‹¨[/ì˜ë£Œê±´ê°•ì •ë³´] ë°›ì•„ ì•½ì„ ë°›ì•˜ì–´ìš”.
            ê²°ê³¼ >> ì¸ì ì‚¬í•­ 3ê±´, ì‹ ì²´ì ì •ë³´ 1ê±´, ì‚¬íšŒì ì •ë³´ 0ê±´, ì¬ì‚°ì ì •ë³´ 0ê±´, ì •ì‹ ì  ì •ë³´ 0ê±´, ê¸°íƒ€ ì •ë³´ 0ê±´
        """
    system_instruction_second = \
        """
            ## ê°œì¸ì •ë³´ íƒì§€ ìˆ˜í–‰ ë°©ë²•
            1. ì…ë ¥ëœ ê²Œì‹œë¬¼ ë‚´ìš©ì´ ê°œì¸ì •ë³´ ìš”ì†Œì— í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”. 
            2. ë‹µë³€ ì‹œ ì…ë ¥ëœ ê²Œì‹œë¬¼ì—ì„œ ê°œì¸ì •ë³´ ìš”ì†ŒëŠ” í•´ë‹¹ ë‚´ìš©ì— ë§ëŠ” [ ] íƒœê·¸ë¡œ í‘œì‹œí•´ ì£¼ì„¸ìš”.
            3. íƒì§€ ì˜ˆì‹œì˜ ìŠ¤íƒ€ì¼ê³¼ ë™ì¼í•˜ê²Œ ë‹µë³€ì„ í•´ì£¼ì„¸ìš”. ë‹µë³€ì—ëŠ” ì…ë ¥, íƒœê·¸, ê²°ê³¼ê°€ ëª¨ë‘ í¬í•¨ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
            4. ì…ë ¥ëœ ë‹µë³€ì„ ë¶„ì„í•œ ë’¤ ë§ˆì§€ë§‰ì— ìµœì¢… ë‹µë³€ì„ ì¶œë ¥í•˜ì‹œì˜¤.
            5. ê²°ê³¼ëŠ” ì¸ì ì‚¬í•­, ì‹ ì²´ì ì •ë³´, ì‚¬íšŒì ì •ë³´, ì¬ì‚°ì ì •ë³´, ì •ì‹ ì  ì •ë³´, ê¸°íƒ€ ì •ë³´ì— ëŒ€í•´ì„œë§Œ ì§‘ê³„í•˜ì„¸ìš”.
            
            ## ê°œì¸ì •ë³´ ìš”ì†Œ
            1. ì¸ì ì‚¬í•­
                1.1 ì¼ë°˜ì •ë³´: ì„±ëª…, ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸, ì£¼ì†Œ, ì—°ë½ì²˜, ìƒë…„ì›”ì¼, ì¶œìƒì§€, ì„±ë³„ ë“±
                1.2 ê°€ì¡±ì •ë³´: ê°€ì¡±ê´€ê³„ ë° ê°€ì¡±êµ¬ì„±ì› ì •ë³´ ë“±
            2. ì‹ ì²´ì  ì •ë³´
                2.1 ì‹ ì²´ì •ë³´: ì–¼êµ´, í™ì±„, ìŒì„±, ìœ ì „ì ì •ë³´, ì§€ë¬¸, í‚¤, ëª¸ë¬´ê²Œ, ì‚¬ì§„ì´ë‚˜ ë™ì˜ìƒì— ë‚˜ì˜¨ ëª¨ìŠµ  ë“±
                2.2 ì˜ë£Œê±´ê°•ì •ë³´: ê±´ê°•ìƒíƒœ, ì§„ë£Œê¸°ë¡, ì‹ ì²´ì¥ì• , ì¥ì• ë“±ê¸‰, ë³‘ë ¥, í˜ˆì•¡í˜•, IQ, ì•½ë¬¼í…ŒìŠ¤íŠ¸ ë“±ì˜ ì‹ ì²´ê²€ì‚¬ ì •ë³´ ë“±
            3. ì‚¬íšŒì ì •ë³´
                3.1 êµìœ¡ì •ë³´: í•™ë ¥, ì„±ì , ì¶œì„í˜„í™©, ê¸°ìˆ  ìê²©ì¦ ë° ì „ë¬¸ ë©´í—ˆì¦ ë³´ìœ ë‚´ì—­, ìƒë²Œê¸°ë¡, ìƒí™œê¸°ë¡ë¶€, ê±´ê°•ê¸°ë¡ë¶€ ë“±
                3.2 ë³‘ì—­ì •ë³´: ë³‘ì—­ì—¬ë¶€, êµ°ë²ˆ ë° ê³„ê¸‰, ì œëŒ€ìœ í˜•, ê·¼ë¬´ë¶€ëŒ€, ì£¼íŠ¹ê¸° ë“±
                3.3 ê·¼ë¡œì •ë³´: ì§ì¥, ê³ ìš©ì£¼, ê·¼ë¬´ì²˜, ê·¼ë¡œê²½ë ¥, ìƒë²Œê¸°ë¡, ì§ë¬´í‰ê°€ê¸°ë¡ ë“±
                3.4 ë²•ì ì •ë³´: ì „ê³¼ ë²”ì£„ ê¸°ë¡, ì¬íŒ ê¸°ë¡, ê³¼íƒœë£Œ ë‚©ë¶€ë‚´ì—­ ë“±
            4. ì¬ì‚°ì  ì •ë³´
                4.1 ì†Œë“ì •ë³´: ë´‰ê¸‰ì•¡, ë³´ë„ˆìŠ¤ ë° ìˆ˜ìˆ˜ë£Œ, ì´ìì†Œë“, ì‚¬ì—…ì†Œë“ ë“±
                4.2 ì‹ ìš©ì •ë³´: ëŒ€ì¶œ ë° ë‹´ë³´ì„¤ì • ë‚´ì—­, ì‹ ìš©ì¹´ë“œë²ˆí˜¸, í†µì¥ê³„ì¢Œë²ˆí˜¸, ì‹ ìš©í‰ê°€ ì •ë³´ ë“±
                4.3 ë¶€ë™ì‚°ì •ë³´: ì†Œìœ ì£¼íƒ, í† ì§€, ìë™ì°¨, ê¸°íƒ€ ì†Œìœ ì°¨ëŸ‰, ìƒì  ë° ê±´ë¬¼ ë“±
                4.4 ê¸°íƒ€ìˆ˜ìµì •ë³´: ë³´í—˜(ê±´ê°•, ìƒëª… ë“±), ê°€ì…í˜„í™©, íœ´ê°€, ë³‘ê°€ ë“±
            5. ì •ì‹ ì  ì •ë³´
                5.1 ê¸°í˜¸.ì„±í–¥ ì •ë³´: ë„ì„œ.ë¹„ë””ì˜¤ ë“± ëŒ€ì—¬ê¸°ë¡, ì¡ì§€êµ¬ë…ì •ë³´, ë¬¼í’ˆêµ¬ë§¤ë‚´ì—­, ì›¹ì‚¬ì´íŠ¸ê²€ìƒ‰ë‚´ì—­ ë“±
                5.2 ë‚´ë©´ì˜ ë¹„ë°€ ì •ë³´: ì‚¬ìƒ, ì‹ ì¡°, ì¢…êµ, ê°€ì¹˜ê´€, ì •ë‹¹.ë…¸ì¡° ê°€ì…ì—¬ë¶€ ë° í™œë™ë‚´ì—­, ì¸í„°ë„· ëŒ“ê¸€.ê²Œì‹œê¸€, ì¶œíŒë¬¼ ë“±
            6. ê¸°íƒ€ ì •ë³´
                6.1 í†µì‹ ì •ë³´: E-mail ì£¼ì†Œ, ì „í™”í†µí™”ë‚´ì—­, ë¡œê·¸íŒŒì¼, ì¿ í‚¤, SNS ì£¼ì†Œ ë“±
                6.2 ìœ„ì¹˜ì •ë³´: GPS ë° íœ´ëŒ€í°ì— ì˜í•œ ê°œì¸ì˜ ìœ„ì¹˜ì •ë³´ ë“±
                6.3 ìŠµê´€ë°ì·¨ë¯¸ì •ë³´: í¡ì—°ì—¬ë¶€, ìŒì£¼ëŸ‰, ì„ í˜¸í•˜ëŠ” ìŠ¤í¬ì¸  ë° ì˜¤ë½, ì—¬ê°€í™œë™, ë„ë°•ì„±ì„±í–¥ ë“±

            ## ìµœì¢… ë‹µë³€
            ì…ë ¥ >> ì–´ì œëŠ” ì¸ì²œ ë‚¨ë™êµ¬ë³µì§€ê´€ ì–´ìš¸ë¦¼ë´‰ì‚¬ë‹¨ì—ì„œ ì¸ì‚¬ë‚˜ëˆ”ìœ¼ë¡œ ë§ˆìŠ¤í¬ 5ë§¤ì™€ ì‚¬íƒ•ì„ ë™ëŒ€í‘œ ì •í˜¸ì”¨ì™€ ì£¼ë¯¼ë“¤ì—ê²Œ ë‚˜ëˆ„ì–´ ì£¼ì—ˆìŠµë‹ˆë‹¤. ì•„ë“¤ë„ í•¨ê»˜ ë‚˜ì˜¨ ì •í˜¸ì”¨ëŠ” ê³ ì§€í˜ˆì¦ì„  3ë…„ì „ì— ì§„ë‹¨ ë°›ì•„ ì•½ì„ ë°›ì•˜ì–´ìš”.
            íƒœê·¸ >> ì–´ì œëŠ” [ì£¼ì†Œ]ì¸ì²œ ë‚¨ë™êµ¬[/ì£¼ì†Œ]ë³µì§€ê´€ ì–´ìš¸ë¦¼ë´‰ì‚¬ë‹¨ì—ì„œ ì¸ì‚¬ë‚˜ëˆ”ìœ¼ë¡œ ë§ˆìŠ¤í¬ 5ë§¤ì™€ ì‚¬íƒ•ì„ ë™ëŒ€í‘œ [ì´ë¦„]ì •í˜¸ì”¨[/ì´ë¦„]ì™€ ì£¼ë¯¼ë“¤ì—ê²Œ ë‚˜ëˆ„ì–´ ì£¼ì—ˆìŠµë‹ˆë‹¤. [ê°€ì¡±ê´€ê³„]ì•„ë“¤[/ê°€ì¡±ê´€ê³„]ë„ í•¨ê»˜ ë‚˜ì˜¨ ì •í˜¸ì”¨ëŠ” [ì˜ë£Œê±´ê°•ì •ë³´]ê³ ì§€í˜ˆì¦ì„  3ë…„ì „ì— ì§„ë‹¨[/ì˜ë£Œê±´ê°•ì •ë³´] ë°›ì•„ ì•½ì„ ë°›ì•˜ì–´ìš”.
            ê²°ê³¼ >> ì¸ì ì‚¬í•­ 3ê±´, ì‹ ì²´ì ì •ë³´ 1ê±´, ì‚¬íšŒì ì •ë³´ 0ê±´, ì¬ì‚°ì ì •ë³´ 0ê±´, ì •ì‹ ì  ì •ë³´ 0ê±´, ê¸°íƒ€ ì •ë³´ 0ê±´

        """

    model_first = genai.GenerativeModel("gemini-1.5-flash", system_instruction=system_instruction_first)
    model_second = genai.GenerativeModel("gemini-1.5-flash", system_instruction=system_instruction_second)
    chat_session_first = model_first.start_chat(history=[])
    chat_session_second = model_second.start_chat(history=[])

    # ì‚¬ìš©ì ì…ë ¥ ë°›ê¸°
    user_input = st.text_area("í…ìŠ¤íŠ¸ ì…ë ¥", placeholder="ë¶„ì„í•  í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”...")
    if user_input:
        if st.button("ë¶„ì„ ì‹œì‘"):
            # First Stage
            input_first = f"""
                ## íƒì§€
                ì…ë ¥ >> {user_input}
                íƒœê·¸ >>
                ê²°ê³¼ >>
            """
            response_first = chat_session_first.send_message(input_first)
            output_first = response_first.text.strip().split('\n')

            # Second Stage
            input_second = f"""
                ## ë‹µë³€
                ì…ë ¥ >> {output_first[0]}
                íƒœê·¸ >> {output_first[1]}
                ê²°ê³¼ >> {output_first[2]}

                ## ì°¨ê·¼ì°¨ê·¼ ë¶„ì„í•´ë³´ì
                ì‘ì„±ë°©ë²•ì— ë§ì¶”ì–´ ì‘ì„±í–ˆëŠ”ì§€ ë¶„ì„í•˜ì‹œì˜¤.
                ë¶„ì„í•œ ê²°ê³¼ë¥¼ ì°¸ê³ í•˜ì—¬ ê° íƒœê·¸ê°€ ì˜¬ë°”ë¥´ê²Œ ë¶„ë¥˜ë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ë³´ì‹œì˜¤.
                ë¶„ì„í•œ ê²°ê³¼ë¥¼ ì°¸ê³ í•˜ì—¬ ê²°ê³¼ì—ì„œ ì§‘ê³„í•œ ê±´ìˆ˜ê°€ ì •í™•í•œì§€ í™•ì¸í•´ë³´ì‹œì˜¤.
                ê°œì¸ì •ë³´ íƒì§€ ìˆ˜í–‰ ë°©ë²•ì— ì•Œë§ê²Œ ë‹µë³€ì„ ìˆ˜ì •í•˜ì‹œì˜¤.

                ## ìµœì¢… ë‹µë³€
                ì…ë ¥ >> {output_first[0]}
                íƒœê·¸ >> 
                ê²°ê³¼ >> ì¸ì ì‚¬í•­ _ê±´, ì‹ ì²´ì ì •ë³´ _ê±´, ì‚¬íšŒì ì •ë³´ _ê±´, ì¬ì‚°ì ì •ë³´ _ê±´, ì •ì‹ ì  ì •ë³´ _ê±´, ê¸°íƒ€ ì •ë³´ _ê±´
            """
            response_second = chat_session_second.send_message(input_second)

            # ê²°ê³¼ ì¶œë ¥
            st.subheader("ë¶„ì„ ê²°ê³¼")

            # ê²°ê³¼ ë°ì´í„° íŒŒì‹±
            result_lines = response_second.text.strip().split('\n')
            formatted_result = {
                "ì…ë ¥": "",
                "íƒœê·¸": "",
                "ê²°ê³¼": ""
            }

            for line in result_lines:
                if line.startswith("ì…ë ¥ >>"):
                    formatted_result["ì…ë ¥"] = line.replace("ì…ë ¥ >>", "").strip()
                elif line.startswith("íƒœê·¸ >>"):
                    formatted_result["íƒœê·¸"] = line.replace("íƒœê·¸ >>", "").strip()
                elif line.startswith("ê²°ê³¼ >>"):
                    formatted_result["ê²°ê³¼"] = line.replace("ê²°ê³¼ >>", "").strip()

            # ê²°ê³¼ í‘œì‹œ
            st.write("**ì…ë ¥ëœ í…ìŠ¤íŠ¸**")
            st.text_area("ì…ë ¥", value=formatted_result["ì…ë ¥"], height=150, disabled=True)

            st.write("**íƒì§€ëœ íƒœê·¸**")
            st.text_area("íƒœê·¸", value=formatted_result["íƒœê·¸"], height=150, disabled=True)

            # ì§‘ê³„ ê²°ê³¼ë¥¼ í‘œ í˜•ì‹ìœ¼ë¡œ ì •ë¦¬
            st.write("**ì§‘ê³„ ê²°ê³¼**")
            summary_data = {
                "êµ¬ë¶„": ["ì¸ì ì‚¬í•­", "ì‹ ì²´ì  ì •ë³´", "ì‚¬íšŒì  ì •ë³´", "ì¬ì‚°ì  ì •ë³´", "ì •ì‹ ì  ì •ë³´", "ê¸°íƒ€ ì •ë³´"],
                "ê±´ìˆ˜": [
                    formatted_result["ê²°ê³¼"].split(', ')[0].split()[-1],
                    formatted_result["ê²°ê³¼"].split(', ')[1].split()[-1],
                    formatted_result["ê²°ê³¼"].split(', ')[2].split()[-1],
                    formatted_result["ê²°ê³¼"].split(', ')[3].split()[-1],
                    formatted_result["ê²°ê³¼"].split(', ')[4].split()[-1],
                    formatted_result["ê²°ê³¼"].split(', ')[5].split()[-1],
                ]
            }
            st.table(summary_data)

            # ìƒì„¸ ë¶„ì„ ê²°ê³¼ë¥¼ ìˆ¨ê¸¸ ìˆ˜ ìˆëŠ” ì„¹ì…˜ìœ¼ë¡œ í‘œì‹œ
            with st.expander("ìƒì„¸ ë¶„ì„ ê²°ê³¼ ë³´ê¸°"):
                st.markdown(response_second.text)



